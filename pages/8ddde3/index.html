<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Zookeeper | Memorydoc</title>
    <meta name="generator" content="VuePress 1.9.5">
    <link rel="icon" href="/img/favicon.ico">
    <meta name="description" content="计算机技术、前端、后端、大数据、微服务、高性能框架、架构、数据结构、算法、RPC、SpringBoot、SpringCloud、Dubbo、并发编程。">
    <meta name="keywords" content="计算机技术、前端、后端、大数据、微服务、高性能框架、架构、数据结构、算法、RPC、SpringBoot、SpringCloud、Dubbo、并发编程">
    <meta name="baidu-site-verification" content="7F55weZDDc">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/assets/css/0.styles.49dd1267.css" as="style"><link rel="preload" href="/assets/js/app.25d5bd39.js" as="script"><link rel="preload" href="/assets/js/2.da1b78fa.js" as="script"><link rel="preload" href="/assets/js/3.c45fb83a.js" as="script"><link rel="preload" href="/assets/js/90.76049e9d.js" as="script"><link rel="prefetch" href="/assets/js/10.ecb9c0a1.js"><link rel="prefetch" href="/assets/js/100.206ed983.js"><link rel="prefetch" href="/assets/js/101.f1d85f50.js"><link rel="prefetch" href="/assets/js/102.c2a93d4a.js"><link rel="prefetch" href="/assets/js/103.f1e9cd2b.js"><link rel="prefetch" href="/assets/js/104.0f8f61b8.js"><link rel="prefetch" href="/assets/js/105.930ed19f.js"><link rel="prefetch" href="/assets/js/106.08506098.js"><link rel="prefetch" href="/assets/js/107.3b93b9c9.js"><link rel="prefetch" href="/assets/js/108.206c968a.js"><link rel="prefetch" href="/assets/js/109.6b5b37fe.js"><link rel="prefetch" href="/assets/js/11.1e5d7a23.js"><link rel="prefetch" href="/assets/js/110.100bed15.js"><link rel="prefetch" href="/assets/js/111.72ce8516.js"><link rel="prefetch" href="/assets/js/112.3ac993a3.js"><link rel="prefetch" href="/assets/js/113.5fdbf696.js"><link rel="prefetch" href="/assets/js/114.811fcfeb.js"><link rel="prefetch" href="/assets/js/115.dad856d3.js"><link rel="prefetch" href="/assets/js/116.54a50252.js"><link rel="prefetch" href="/assets/js/117.cd7ac9bf.js"><link rel="prefetch" href="/assets/js/118.3c4286db.js"><link rel="prefetch" href="/assets/js/119.a949aead.js"><link rel="prefetch" href="/assets/js/12.b0a914c2.js"><link rel="prefetch" href="/assets/js/120.c4531bd8.js"><link rel="prefetch" href="/assets/js/121.942fc70f.js"><link rel="prefetch" href="/assets/js/122.2144ab4c.js"><link rel="prefetch" href="/assets/js/123.789ee4f0.js"><link rel="prefetch" href="/assets/js/124.d1141f29.js"><link rel="prefetch" href="/assets/js/125.e392515f.js"><link rel="prefetch" href="/assets/js/126.7939c6ae.js"><link rel="prefetch" href="/assets/js/127.a8034839.js"><link rel="prefetch" href="/assets/js/128.243ffdb5.js"><link rel="prefetch" href="/assets/js/129.052e6351.js"><link rel="prefetch" href="/assets/js/13.8a17b405.js"><link rel="prefetch" href="/assets/js/130.e40711d0.js"><link rel="prefetch" href="/assets/js/131.4dd33876.js"><link rel="prefetch" href="/assets/js/132.6c10fb01.js"><link rel="prefetch" href="/assets/js/133.593db447.js"><link rel="prefetch" href="/assets/js/134.58b78663.js"><link rel="prefetch" href="/assets/js/135.00bc55a8.js"><link rel="prefetch" href="/assets/js/136.17cee463.js"><link rel="prefetch" href="/assets/js/137.54f21198.js"><link rel="prefetch" href="/assets/js/138.57f02219.js"><link rel="prefetch" href="/assets/js/139.0e96803a.js"><link rel="prefetch" href="/assets/js/14.b00fceec.js"><link rel="prefetch" href="/assets/js/140.94fd7c64.js"><link rel="prefetch" href="/assets/js/141.91ed8a35.js"><link rel="prefetch" href="/assets/js/142.45f64d2c.js"><link rel="prefetch" href="/assets/js/143.33c44171.js"><link rel="prefetch" href="/assets/js/144.ce9133c0.js"><link rel="prefetch" href="/assets/js/145.0261f474.js"><link rel="prefetch" href="/assets/js/146.d169ebf8.js"><link rel="prefetch" href="/assets/js/147.3a85443e.js"><link rel="prefetch" href="/assets/js/148.977082a5.js"><link rel="prefetch" href="/assets/js/149.d06ba65d.js"><link rel="prefetch" href="/assets/js/15.097c2bad.js"><link rel="prefetch" href="/assets/js/150.e45ce85f.js"><link rel="prefetch" href="/assets/js/151.96d487fd.js"><link rel="prefetch" href="/assets/js/152.bff1944e.js"><link rel="prefetch" href="/assets/js/153.de84d3b6.js"><link rel="prefetch" href="/assets/js/154.496243aa.js"><link rel="prefetch" href="/assets/js/155.c1d64041.js"><link rel="prefetch" href="/assets/js/156.335486f4.js"><link rel="prefetch" href="/assets/js/157.9f9c11f8.js"><link rel="prefetch" href="/assets/js/158.0cdb35e3.js"><link rel="prefetch" href="/assets/js/159.0d18ee42.js"><link rel="prefetch" href="/assets/js/16.d3f33b70.js"><link rel="prefetch" href="/assets/js/160.3b847b9e.js"><link rel="prefetch" href="/assets/js/161.bd731692.js"><link rel="prefetch" href="/assets/js/162.301a6f0b.js"><link rel="prefetch" href="/assets/js/163.010e12c5.js"><link rel="prefetch" href="/assets/js/164.454514c5.js"><link rel="prefetch" href="/assets/js/165.7789af1c.js"><link rel="prefetch" href="/assets/js/166.47d73ba1.js"><link rel="prefetch" href="/assets/js/167.c06b8f78.js"><link rel="prefetch" href="/assets/js/168.61c791ee.js"><link rel="prefetch" href="/assets/js/169.e6f22ddd.js"><link rel="prefetch" href="/assets/js/17.57c1e124.js"><link rel="prefetch" href="/assets/js/170.62d88bd4.js"><link rel="prefetch" href="/assets/js/171.40f772ae.js"><link rel="prefetch" href="/assets/js/172.66b40886.js"><link rel="prefetch" href="/assets/js/173.f34d809d.js"><link rel="prefetch" href="/assets/js/174.db5e3f19.js"><link rel="prefetch" href="/assets/js/175.b56231d5.js"><link rel="prefetch" href="/assets/js/176.00c9a60e.js"><link rel="prefetch" href="/assets/js/177.87d52c78.js"><link rel="prefetch" href="/assets/js/178.31ed8b6d.js"><link rel="prefetch" href="/assets/js/179.fddc207a.js"><link rel="prefetch" href="/assets/js/18.d8759a1e.js"><link rel="prefetch" href="/assets/js/180.621cba53.js"><link rel="prefetch" href="/assets/js/181.2a569de3.js"><link rel="prefetch" href="/assets/js/182.d2a57f56.js"><link rel="prefetch" href="/assets/js/183.092e9d38.js"><link rel="prefetch" href="/assets/js/184.5e18dfc2.js"><link rel="prefetch" href="/assets/js/185.664f0b42.js"><link rel="prefetch" href="/assets/js/186.7e22ed8d.js"><link rel="prefetch" href="/assets/js/187.5c44e025.js"><link rel="prefetch" href="/assets/js/188.91b9bbd8.js"><link rel="prefetch" href="/assets/js/189.6e0b5ebd.js"><link rel="prefetch" href="/assets/js/19.d37b732b.js"><link rel="prefetch" href="/assets/js/190.f6abc3d7.js"><link rel="prefetch" href="/assets/js/191.37390a45.js"><link rel="prefetch" href="/assets/js/192.7cf4020f.js"><link rel="prefetch" href="/assets/js/193.4d3114c9.js"><link rel="prefetch" href="/assets/js/194.e2da3db9.js"><link rel="prefetch" href="/assets/js/195.aafc304f.js"><link rel="prefetch" href="/assets/js/196.0cab5d55.js"><link rel="prefetch" href="/assets/js/197.1b308aef.js"><link rel="prefetch" href="/assets/js/198.027b6ac1.js"><link rel="prefetch" href="/assets/js/199.1ff3911e.js"><link rel="prefetch" href="/assets/js/20.28bae9d0.js"><link rel="prefetch" href="/assets/js/200.64c68854.js"><link rel="prefetch" href="/assets/js/201.4b6d2a10.js"><link rel="prefetch" href="/assets/js/202.0405fd2a.js"><link rel="prefetch" href="/assets/js/203.627a8465.js"><link rel="prefetch" href="/assets/js/204.5b2a60f5.js"><link rel="prefetch" href="/assets/js/205.7480cc4f.js"><link rel="prefetch" href="/assets/js/206.c43a6b50.js"><link rel="prefetch" href="/assets/js/207.279d0107.js"><link rel="prefetch" href="/assets/js/208.c45f6d14.js"><link rel="prefetch" href="/assets/js/209.dfc6cc6f.js"><link rel="prefetch" href="/assets/js/21.c6035f36.js"><link rel="prefetch" href="/assets/js/210.50325915.js"><link rel="prefetch" href="/assets/js/211.01972d87.js"><link rel="prefetch" href="/assets/js/212.c311d763.js"><link rel="prefetch" href="/assets/js/213.ab827bba.js"><link rel="prefetch" href="/assets/js/214.463721d0.js"><link rel="prefetch" href="/assets/js/215.ebf4e434.js"><link rel="prefetch" href="/assets/js/216.6de1df4c.js"><link rel="prefetch" href="/assets/js/217.83ee1c36.js"><link rel="prefetch" href="/assets/js/218.25d4170f.js"><link rel="prefetch" href="/assets/js/219.1d50f281.js"><link rel="prefetch" href="/assets/js/22.4a3e3259.js"><link rel="prefetch" href="/assets/js/220.46055d1c.js"><link rel="prefetch" href="/assets/js/221.6bd64a96.js"><link rel="prefetch" href="/assets/js/222.77b673e9.js"><link rel="prefetch" href="/assets/js/223.bfb2b5a7.js"><link rel="prefetch" href="/assets/js/224.70dc8d60.js"><link rel="prefetch" href="/assets/js/225.ec71b6c3.js"><link rel="prefetch" href="/assets/js/226.5352db61.js"><link rel="prefetch" href="/assets/js/227.ead26aa8.js"><link rel="prefetch" href="/assets/js/228.e5599691.js"><link rel="prefetch" href="/assets/js/229.7b82e7e9.js"><link rel="prefetch" href="/assets/js/23.1f28e8ab.js"><link rel="prefetch" href="/assets/js/230.0d9a8297.js"><link rel="prefetch" href="/assets/js/231.a5a2ae12.js"><link rel="prefetch" href="/assets/js/232.53c542b4.js"><link rel="prefetch" href="/assets/js/233.ae5bb0cc.js"><link rel="prefetch" href="/assets/js/234.6b08420a.js"><link rel="prefetch" href="/assets/js/235.44905de5.js"><link rel="prefetch" href="/assets/js/236.1e42282c.js"><link rel="prefetch" href="/assets/js/237.76ea25ae.js"><link rel="prefetch" href="/assets/js/238.8e8d9c51.js"><link rel="prefetch" href="/assets/js/239.9319cbc0.js"><link rel="prefetch" href="/assets/js/24.3e3b550e.js"><link rel="prefetch" href="/assets/js/240.fc77cb13.js"><link rel="prefetch" href="/assets/js/241.ab189807.js"><link rel="prefetch" href="/assets/js/242.b2900b68.js"><link rel="prefetch" href="/assets/js/243.99a899f3.js"><link rel="prefetch" href="/assets/js/244.c2ee7b93.js"><link rel="prefetch" href="/assets/js/245.de873fa0.js"><link rel="prefetch" href="/assets/js/246.b912dc33.js"><link rel="prefetch" href="/assets/js/247.09b899c5.js"><link rel="prefetch" href="/assets/js/248.54ad9a67.js"><link rel="prefetch" href="/assets/js/249.b39c8a25.js"><link rel="prefetch" href="/assets/js/25.d928c05c.js"><link rel="prefetch" href="/assets/js/250.459bac0e.js"><link rel="prefetch" href="/assets/js/251.39e3ec36.js"><link rel="prefetch" href="/assets/js/252.ec7dbdc8.js"><link rel="prefetch" href="/assets/js/253.50b74f22.js"><link rel="prefetch" href="/assets/js/254.d14e479e.js"><link rel="prefetch" href="/assets/js/255.584eceb2.js"><link rel="prefetch" href="/assets/js/256.ae1c292a.js"><link rel="prefetch" href="/assets/js/257.44c2b8cf.js"><link rel="prefetch" href="/assets/js/258.fa53d821.js"><link rel="prefetch" href="/assets/js/259.774d310d.js"><link rel="prefetch" href="/assets/js/26.f729d047.js"><link rel="prefetch" href="/assets/js/260.c0d77fe0.js"><link rel="prefetch" href="/assets/js/261.ca254cbf.js"><link rel="prefetch" href="/assets/js/262.709eab6a.js"><link rel="prefetch" href="/assets/js/263.1abf59e0.js"><link rel="prefetch" href="/assets/js/264.f8cae5ea.js"><link rel="prefetch" href="/assets/js/265.3bb2db9b.js"><link rel="prefetch" href="/assets/js/266.8fd1f58d.js"><link rel="prefetch" href="/assets/js/267.3d3cb32b.js"><link rel="prefetch" href="/assets/js/268.be1f775d.js"><link rel="prefetch" href="/assets/js/269.956dca63.js"><link rel="prefetch" href="/assets/js/27.bdede19f.js"><link rel="prefetch" href="/assets/js/270.9e3534c2.js"><link rel="prefetch" href="/assets/js/271.19292a6a.js"><link rel="prefetch" href="/assets/js/272.be14a17e.js"><link rel="prefetch" href="/assets/js/273.e501d9dd.js"><link rel="prefetch" href="/assets/js/274.76397e7d.js"><link rel="prefetch" href="/assets/js/275.e33c8288.js"><link rel="prefetch" href="/assets/js/276.7f89722f.js"><link rel="prefetch" href="/assets/js/277.bcb6b0e8.js"><link rel="prefetch" href="/assets/js/278.05ceb6af.js"><link rel="prefetch" href="/assets/js/279.61674e63.js"><link rel="prefetch" href="/assets/js/28.fde9d738.js"><link rel="prefetch" href="/assets/js/280.474c67de.js"><link rel="prefetch" href="/assets/js/281.1e17024e.js"><link rel="prefetch" href="/assets/js/282.db8ddeb6.js"><link rel="prefetch" href="/assets/js/283.b288c8bb.js"><link rel="prefetch" href="/assets/js/284.c417b9e0.js"><link rel="prefetch" href="/assets/js/285.e53d49aa.js"><link rel="prefetch" href="/assets/js/286.4a7baf12.js"><link rel="prefetch" href="/assets/js/287.7591f1b4.js"><link rel="prefetch" href="/assets/js/288.0912053e.js"><link rel="prefetch" href="/assets/js/289.978572a8.js"><link rel="prefetch" href="/assets/js/29.4c8b01c8.js"><link rel="prefetch" href="/assets/js/290.7a85ed94.js"><link rel="prefetch" href="/assets/js/291.847f05eb.js"><link rel="prefetch" href="/assets/js/292.2e44410e.js"><link rel="prefetch" href="/assets/js/293.0d45cdd4.js"><link rel="prefetch" href="/assets/js/294.e3b7b25f.js"><link rel="prefetch" href="/assets/js/295.29a3b26b.js"><link rel="prefetch" href="/assets/js/296.bc4498fc.js"><link rel="prefetch" href="/assets/js/297.c60d8b06.js"><link rel="prefetch" href="/assets/js/298.59a3e24d.js"><link rel="prefetch" href="/assets/js/299.d3c2d424.js"><link rel="prefetch" href="/assets/js/30.ead08016.js"><link rel="prefetch" href="/assets/js/300.df47845b.js"><link rel="prefetch" href="/assets/js/301.cea933c6.js"><link rel="prefetch" href="/assets/js/302.bd59a520.js"><link rel="prefetch" href="/assets/js/303.581ef148.js"><link rel="prefetch" href="/assets/js/304.d5d9f6e2.js"><link rel="prefetch" href="/assets/js/305.135a30a7.js"><link rel="prefetch" href="/assets/js/306.3e0d914a.js"><link rel="prefetch" href="/assets/js/307.336d751e.js"><link rel="prefetch" href="/assets/js/308.65586bfd.js"><link rel="prefetch" href="/assets/js/309.98b1b949.js"><link rel="prefetch" href="/assets/js/31.02f09009.js"><link rel="prefetch" href="/assets/js/310.da87da15.js"><link rel="prefetch" href="/assets/js/311.bde9a024.js"><link rel="prefetch" href="/assets/js/312.14e40f24.js"><link rel="prefetch" href="/assets/js/313.b1f4ac85.js"><link rel="prefetch" href="/assets/js/314.d2c2375a.js"><link rel="prefetch" href="/assets/js/315.05b67707.js"><link rel="prefetch" href="/assets/js/32.f594dd6c.js"><link rel="prefetch" href="/assets/js/33.22124bfe.js"><link rel="prefetch" href="/assets/js/34.c7844b35.js"><link rel="prefetch" href="/assets/js/35.d5667642.js"><link rel="prefetch" href="/assets/js/36.bfcf6d37.js"><link rel="prefetch" href="/assets/js/37.a4d69365.js"><link rel="prefetch" href="/assets/js/38.43349fb3.js"><link rel="prefetch" href="/assets/js/39.7f29dbb5.js"><link rel="prefetch" href="/assets/js/4.c3c7a0a0.js"><link rel="prefetch" href="/assets/js/40.226573d8.js"><link rel="prefetch" href="/assets/js/41.cd73bf3a.js"><link rel="prefetch" href="/assets/js/42.7a0d2976.js"><link rel="prefetch" href="/assets/js/43.147ef265.js"><link rel="prefetch" href="/assets/js/44.c1dd092f.js"><link rel="prefetch" href="/assets/js/45.88b2cfe8.js"><link rel="prefetch" href="/assets/js/46.bb43d167.js"><link rel="prefetch" href="/assets/js/47.66ae3bd6.js"><link rel="prefetch" href="/assets/js/48.bcd2f5d6.js"><link rel="prefetch" href="/assets/js/49.c903111d.js"><link rel="prefetch" href="/assets/js/5.5de918b4.js"><link rel="prefetch" href="/assets/js/50.6adf0c95.js"><link rel="prefetch" href="/assets/js/51.615afeb8.js"><link rel="prefetch" href="/assets/js/52.22cb9534.js"><link rel="prefetch" href="/assets/js/53.d564fb68.js"><link rel="prefetch" href="/assets/js/54.6c46a3be.js"><link rel="prefetch" href="/assets/js/55.7ec62261.js"><link rel="prefetch" href="/assets/js/56.5ffc667f.js"><link rel="prefetch" href="/assets/js/57.df564138.js"><link rel="prefetch" href="/assets/js/58.2d159677.js"><link rel="prefetch" href="/assets/js/59.09e6acd1.js"><link rel="prefetch" href="/assets/js/6.cd61b72d.js"><link rel="prefetch" href="/assets/js/60.661799f1.js"><link rel="prefetch" href="/assets/js/61.a3060f18.js"><link rel="prefetch" href="/assets/js/62.a3cf22ac.js"><link rel="prefetch" href="/assets/js/63.3b40fb26.js"><link rel="prefetch" href="/assets/js/64.8f122a85.js"><link rel="prefetch" href="/assets/js/65.94ea6a7d.js"><link rel="prefetch" href="/assets/js/66.3264570a.js"><link rel="prefetch" href="/assets/js/67.f734cf4f.js"><link rel="prefetch" href="/assets/js/68.b77f9c45.js"><link rel="prefetch" href="/assets/js/69.670dfecb.js"><link rel="prefetch" href="/assets/js/7.01237d8a.js"><link rel="prefetch" href="/assets/js/70.41c1d50c.js"><link rel="prefetch" href="/assets/js/71.189eb12c.js"><link rel="prefetch" href="/assets/js/72.fbf11f49.js"><link rel="prefetch" href="/assets/js/73.88a8dcf6.js"><link rel="prefetch" href="/assets/js/74.1bfdaebd.js"><link rel="prefetch" href="/assets/js/75.f3deb353.js"><link rel="prefetch" href="/assets/js/76.39ec7a35.js"><link rel="prefetch" href="/assets/js/77.014da067.js"><link rel="prefetch" href="/assets/js/78.968423fd.js"><link rel="prefetch" href="/assets/js/79.43c62e31.js"><link rel="prefetch" href="/assets/js/8.69c06f54.js"><link rel="prefetch" href="/assets/js/80.724ba85c.js"><link rel="prefetch" href="/assets/js/81.2723018a.js"><link rel="prefetch" href="/assets/js/82.9454fd50.js"><link rel="prefetch" href="/assets/js/83.cac4dd34.js"><link rel="prefetch" href="/assets/js/84.335ad95e.js"><link rel="prefetch" href="/assets/js/85.97815704.js"><link rel="prefetch" href="/assets/js/86.521caa3b.js"><link rel="prefetch" href="/assets/js/87.79820634.js"><link rel="prefetch" href="/assets/js/88.35d4530d.js"><link rel="prefetch" href="/assets/js/89.7e873ca5.js"><link rel="prefetch" href="/assets/js/9.8272e5e4.js"><link rel="prefetch" href="/assets/js/91.149569a8.js"><link rel="prefetch" href="/assets/js/92.09f6f94f.js"><link rel="prefetch" href="/assets/js/93.41bc1e06.js"><link rel="prefetch" href="/assets/js/94.e362cc78.js"><link rel="prefetch" href="/assets/js/95.0f881321.js"><link rel="prefetch" href="/assets/js/96.64599b83.js"><link rel="prefetch" href="/assets/js/97.7b0289c3.js"><link rel="prefetch" href="/assets/js/98.f4b38e7a.js"><link rel="prefetch" href="/assets/js/99.0b40f59f.js">
    <link rel="stylesheet" href="/assets/css/0.styles.49dd1267.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Memorydoc</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="大前端" class="dropdown-title"><a href="/web/" class="link-title">大前端</a> <span class="title" style="display:none;">大前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>前端文章</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/8143cc480faf9a11/" class="nav-link">JavaScript</a></li></ul></li><li class="dropdown-item"><h4>学习笔记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note/javascript/" class="nav-link">《JavaScript教程》</a></li><li class="dropdown-subitem"><a href="/note/js/" class="nav-link">《JavaScript高级程序设计》</a></li><li class="dropdown-subitem"><a href="/note/es6/" class="nav-link">《ES6 教程》</a></li><li class="dropdown-subitem"><a href="/note/vue/" class="nav-link">《Vue》</a></li><li class="dropdown-subitem"><a href="/note/react/" class="nav-link">《React》</a></li><li class="dropdown-subitem"><a href="/note/typescript-axios/" class="nav-link">《TypeScript 从零实现 axios》</a></li><li class="dropdown-subitem"><a href="/note/git/" class="nav-link">《Git》</a></li><li class="dropdown-subitem"><a href="/pages/51afd6/" class="nav-link">TypeScript</a></li><li class="dropdown-subitem"><a href="/pages/4643cd/" class="nav-link">JS设计模式总结</a></li><li class="dropdown-subitem"><a href="/pages/8309a5b876fc95e3/" class="nav-link">HTML</a></li><li class="dropdown-subitem"><a href="/pages/0a83b083bdf257cb/" class="nav-link">CSS</a></li><li class="dropdown-subitem"><a href="/pages/4c778760be26d8b3/" class="nav-link">前端拓展</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="技术架构" class="dropdown-title"><a href="/technology/" class="link-title">技术架构</a> <span class="title" style="display:none;">技术架构</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>编程之道</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/55a87c/" class="nav-link">并发编程</a></li><li class="dropdown-subitem"><a href="/pages/548fa0/" class="nav-link">设计模式</a></li><li class="dropdown-subitem"><a href="/pages/88f12b/" class="nav-link">数据结构算法</a></li><li class="dropdown-subitem"><a href="/pages/8a3eef/" class="nav-link">技术拓展</a></li><li class="dropdown-subitem"><a href="/pages/e8b493/" class="nav-link">技术陷阱</a></li><li class="dropdown-subitem"><a href="/pages/86d7d4/" class="nav-link">面试宝典</a></li></ul></li><li class="dropdown-item"><h4>分布式</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/1b9fb0/" class="nav-link">微服务</a></li><li class="dropdown-subitem"><a href="/pages/741469/" class="nav-link">数据库</a></li></ul></li><li class="dropdown-item"><h4>项目优化实战</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/8ddde3/.html" class="nav-link">JVM 优化</a></li><li class="dropdown-subitem"><a href="/pages/8ddde3/.html" class="nav-link">线程池优化</a></li><li class="dropdown-subitem"><a href="/pages/8ddde3/.html" class="nav-link">模板引擎优化</a></li><li class="dropdown-subitem"><a href="/pages/8ddde3/.html" class="nav-link">任务调度优化</a></li><li class="dropdown-subitem"><a href="/pages/8ddde3/.html" class="nav-link">内存优化</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/f2a556/" class="nav-link">学习</a></li><li class="dropdown-item"><!----> <a href="/pages/aea6571b7a8bae86/" class="nav-link">面试</a></li><li class="dropdown-item"><!----> <a href="/pages/2d615df9a36a98ed/" class="nav-link">心情杂货</a></li><li class="dropdown-item"><!----> <a href="/pages/baaa02/" class="nav-link">实用技巧</a></li><li class="dropdown-item"><!----> <a href="/friends/" class="nav-link">友情链接</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/pages/beb6c0bd8a66cea6/" class="nav-link">收藏</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/Memorydoc" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="/img/touxiang.png"> <div class="blogger-info"><h3>Memorydoc</h3> <span>术尚可求</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="大前端" class="dropdown-title"><a href="/web/" class="link-title">大前端</a> <span class="title" style="display:none;">大前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>前端文章</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/8143cc480faf9a11/" class="nav-link">JavaScript</a></li></ul></li><li class="dropdown-item"><h4>学习笔记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note/javascript/" class="nav-link">《JavaScript教程》</a></li><li class="dropdown-subitem"><a href="/note/js/" class="nav-link">《JavaScript高级程序设计》</a></li><li class="dropdown-subitem"><a href="/note/es6/" class="nav-link">《ES6 教程》</a></li><li class="dropdown-subitem"><a href="/note/vue/" class="nav-link">《Vue》</a></li><li class="dropdown-subitem"><a href="/note/react/" class="nav-link">《React》</a></li><li class="dropdown-subitem"><a href="/note/typescript-axios/" class="nav-link">《TypeScript 从零实现 axios》</a></li><li class="dropdown-subitem"><a href="/note/git/" class="nav-link">《Git》</a></li><li class="dropdown-subitem"><a href="/pages/51afd6/" class="nav-link">TypeScript</a></li><li class="dropdown-subitem"><a href="/pages/4643cd/" class="nav-link">JS设计模式总结</a></li><li class="dropdown-subitem"><a href="/pages/8309a5b876fc95e3/" class="nav-link">HTML</a></li><li class="dropdown-subitem"><a href="/pages/0a83b083bdf257cb/" class="nav-link">CSS</a></li><li class="dropdown-subitem"><a href="/pages/4c778760be26d8b3/" class="nav-link">前端拓展</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="技术架构" class="dropdown-title"><a href="/technology/" class="link-title">技术架构</a> <span class="title" style="display:none;">技术架构</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>编程之道</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/55a87c/" class="nav-link">并发编程</a></li><li class="dropdown-subitem"><a href="/pages/548fa0/" class="nav-link">设计模式</a></li><li class="dropdown-subitem"><a href="/pages/88f12b/" class="nav-link">数据结构算法</a></li><li class="dropdown-subitem"><a href="/pages/8a3eef/" class="nav-link">技术拓展</a></li><li class="dropdown-subitem"><a href="/pages/e8b493/" class="nav-link">技术陷阱</a></li><li class="dropdown-subitem"><a href="/pages/86d7d4/" class="nav-link">面试宝典</a></li></ul></li><li class="dropdown-item"><h4>分布式</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/1b9fb0/" class="nav-link">微服务</a></li><li class="dropdown-subitem"><a href="/pages/741469/" class="nav-link">数据库</a></li></ul></li><li class="dropdown-item"><h4>项目优化实战</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/8ddde3/.html" class="nav-link">JVM 优化</a></li><li class="dropdown-subitem"><a href="/pages/8ddde3/.html" class="nav-link">线程池优化</a></li><li class="dropdown-subitem"><a href="/pages/8ddde3/.html" class="nav-link">模板引擎优化</a></li><li class="dropdown-subitem"><a href="/pages/8ddde3/.html" class="nav-link">任务调度优化</a></li><li class="dropdown-subitem"><a href="/pages/8ddde3/.html" class="nav-link">内存优化</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/f2a556/" class="nav-link">学习</a></li><li class="dropdown-item"><!----> <a href="/pages/aea6571b7a8bae86/" class="nav-link">面试</a></li><li class="dropdown-item"><!----> <a href="/pages/2d615df9a36a98ed/" class="nav-link">心情杂货</a></li><li class="dropdown-item"><!----> <a href="/pages/baaa02/" class="nav-link">实用技巧</a></li><li class="dropdown-item"><!----> <a href="/friends/" class="nav-link">友情链接</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/pages/beb6c0bd8a66cea6/" class="nav-link">收藏</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/Memorydoc" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>并发编程</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>设计模式</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>数据结构算法</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>技术拓展</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>技术陷阱</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>面试宝典</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>微服务</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/1b9fb0/" class="sidebar-link">Redis</a></li><li><a href="/pages/a0f472/" class="sidebar-link">分布式锁</a></li><li><a href="/pages/8ddde3/" aria-current="page" class="active sidebar-link">Zookeeper</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/8ddde3/#zookeeper-的数据模型" class="sidebar-link">Zookeeper 的数据模型</a></li><li class="sidebar-sub-header"><a href="/pages/8ddde3/#zookeeper-的基本操作" class="sidebar-link">Zookeeper 的基本操作</a></li><li class="sidebar-sub-header"><a href="/pages/8ddde3/#zookeeper-的事件通知" class="sidebar-link">Zookeeper 的事件通知</a></li><li class="sidebar-sub-header"><a href="/pages/8ddde3/#zookeeper-的一致性" class="sidebar-link">Zookeeper 的一致性</a></li><li class="sidebar-sub-header"><a href="/pages/8ddde3/#zookeeper-的应用场景" class="sidebar-link">Zookeeper 的应用场景</a></li><li class="sidebar-sub-header"><a href="/pages/8ddde3/#基于-docker-安装-zookeeper" class="sidebar-link">基于 Docker 安装 Zookeeper</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/8ddde3/#概述" class="sidebar-link">概述</a></li><li class="sidebar-sub-header"><a href="/pages/8ddde3/#单机模式" class="sidebar-link">单机模式</a></li><li class="sidebar-sub-header"><a href="/pages/8ddde3/#集群模式" class="sidebar-link">集群模式</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/8ddde3/#附-linux-下手动安装-zookeeper" class="sidebar-link">附：Linux 下手动安装 Zookeeper</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/8ddde3/#伪集群模式" class="sidebar-link">伪集群模式</a></li><li class="sidebar-sub-header"><a href="/pages/8ddde3/#启动和停止-2" class="sidebar-link">启动和停止</a></li><li class="sidebar-sub-header"><a href="/pages/8ddde3/#集群模式-2" class="sidebar-link">集群模式</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/8ddde3/#zookeeper-配置说明" class="sidebar-link">Zookeeper 配置说明</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/8ddde3/#zookeeper-的三种工作模式" class="sidebar-link">Zookeeper 的三种工作模式</a></li><li class="sidebar-sub-header"><a href="/pages/8ddde3/#zookeeper-的三种端口号" class="sidebar-link">Zookeeper 的三种端口号</a></li><li class="sidebar-sub-header"><a href="/pages/8ddde3/#zookeeper-单机模式配置文件" class="sidebar-link">Zookeeper 单机模式配置文件</a></li><li class="sidebar-sub-header"><a href="/pages/8ddde3/#zookeeper-集群模式配置文件" class="sidebar-link">Zookeeper 集群模式配置文件</a></li></ul></li></ul></li><li><a href="/pages/9d5b5a/" class="sidebar-link">定时任务</a></li><li><a href="/pages/3d8a22/" class="sidebar-link">RPC实现原理</a></li><li><a href="/pages/abde57/" class="sidebar-link">网站限流</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>数据库</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>项目优化背景</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JVM优化</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-d5e9d2e6><div class="articleInfo" data-v-d5e9d2e6><ul class="breadcrumbs" data-v-d5e9d2e6><li data-v-d5e9d2e6><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-d5e9d2e6></a></li> <li data-v-d5e9d2e6><a href="/technology/#技术架构" data-v-d5e9d2e6>技术架构</a></li><li data-v-d5e9d2e6><a href="/technology/#微服务" data-v-d5e9d2e6>微服务</a></li></ul> <div class="info" data-v-d5e9d2e6><div title="作者" class="author iconfont icon-touxiang" data-v-d5e9d2e6><a href="https://github.com/Memorydoc" target="_blank" title="作者" class="beLink" data-v-d5e9d2e6>Memorydoc</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-d5e9d2e6><a href="javascript:;" data-v-d5e9d2e6>2022-03-07</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABKFJREFUSA3tVl1oFVcQnrMbrak3QUgkya1akpJYcrUtIqW1JvFBE9LiQ5v6JmJpolbMg32rVrhgoYK0QiMY6i9Y6EMaW5D+xFJaTYItIuK2Kr3+BJNwkxBj05sQY3b3nM6cs2dv9t7NT/vQJw/sndk5M/PNzJkzewGerP+pAmy+ON8lLzUJgA8ZYxYIYZmGYRnctDaWvJJAmTtfP1pvXsBCCPP8QFcCaRkZYACgDZFO4stNIcBCajEOlmmC9XpJ9bAGCaPaPmzPl32dvLSVu3BWCTQs0XQQ6g0DYgwLIoAZbBCdW/i+781o1VVlm/410mw4h06Y7bIPHNyWDyL4FHkX03Q8SrzNhZTZriieckWt7cL6MM85YcLpsi/7O9/iXFT6MswI0DmmpkSaJ0qLxFIm3+i1THHB3zmBH3PYx9CcykcLOeQVVa7QtdxTgQgEleX2AjHYfwA+2ddV77ruGoJUbhGDI09YSNXyMpUt5ylOzxgbUmtOp7NmbNt8v3arjTBfYELmLUV+M+nSawNNAUqpT3ClJWg5I3BLT+cGW/DXNGCa6tx1aakCGEigArTn4TDIPdrXXYKCZNrHLMCOEPvHBlLQ99s9eHB7EB6NTki73CVPQ2F5MSx/uRQixfmq7rK0wYD8w8E905bnPDfwoWs/rfv93NWN/ZfvwsLIU7A09gxECyISeGJkHAau98L97tuw7NXnoPyNF8FcYGLGKsOs0mN3OEyec9esGW/ZEl945dTP34wlR2FZVQWU1q0Cw8Tr7p+hgLLNL0FPxx/Q35mA8aEUrH6nCgwEl0tn7wUiZYJnNRh6DK4UH/k0lfyrsBKdPVv/AriGIQcEDQZ65LBAGe2Rzui9Ybjz7XUppz1/uKBbyVPGkN3ZAeC6hr0x7Nr38N5+EqkoOm17xpoqR9ohQF55ERSvr4Dkr3chNfC3DMzGJlNBElW8w9nsGQvhNGIzDkXzCg8cLK951xHsFBlTJspJNi3ZFIMF2AeDV3q8DNOB+YHi6QTrChDIWDBRi5U5f+ZMfJLu3ccrqxtdxk4SKH336LFxSmkqefwU5T8fhdSdQf9IVKD6aNiwI/hnmcAZ91isYMJIaCUCx9W098+LgruikeTqzqqxKPUwqJyCPJiyemVVZBOijDGjD38Os0jOiSPL1z3SPjXNANbiNPXAdzTfukjjuknNBbyz3nwgTd3AVFqUJ5hpHlq9MveLnWwttUfoygBmvVjuikxND3znrhsELnZk7k+OjIGxeNEkomyLVta0xxn+HZhjBc4YZ/AFjHjz9u3xRZl2BN4aq9nFwWh16IrQ1aHHEd3j1+4/dB9OtH4e29A2H1DyHQRmOSfQZ1Fy7MHBTGB6J/Djq6p3OxyO2cB+4Car7v/o3GXgfAkj23+x9ID1Teoamo/SXcbvSf2PX7Vc8DdCmE1vN9di+32P9/5YR3vLnhCVGUWBjEkr3yh4H8v9CzmsbdhzOKzsJKM90iFdaTMjRPhGVsakRvOaRidljo6H6G7j+ctrJpsP+4COhDIl0La2+FS4+5mlocBaXY5QnGZysIBYoeSsl5qQzrSj/cgNrfuEzlWBfwA+EjrZyWUvpAAAAABJRU5ErkJggg==">Zookeeper<!----></h1>  <div class="theme-vdoing-content content__default"><h2 id="zookeeper-的数据模型"><a href="#zookeeper-的数据模型" class="header-anchor">#</a> Zookeeper 的数据模型</h2> <p>Zookeeper 的数据模型是什么样子呢？它很像数据结构当中的树，也很像文件系统的目录。
<img src="/img/microservice/zk12.png" alt="zk1">
树是由节点所组成，Zookeeper 的数据存储也同样是基于节点，这种节点叫做 <strong>Znode</strong></p> <p>但是，不同于树的节点，Znode 的引用方式是路径引用，类似于文件路径：</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>/动物/猫
/汽车/宝马
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>这样的层级结构，让每一个 Znode 节点拥有唯一的路径，就像命名空间一样对不同信息作出清晰的隔离。</p> <h4 id="znode-包含哪些元素"><a href="#znode-包含哪些元素" class="header-anchor">#</a> Znode 包含哪些元素</h4> <p><img src="/img/microservice/zk13.png" alt="zk1"></p> <ul><li>data：Znode 存储的数据信息。</li> <li>ACL：记录 Znode 的访问权限，即哪些人或哪些 IP 可以访问本节点。</li> <li>stat：包含 Znode 的各种元数据，比如事务 ID、版本号、时间戳、大小等等。</li> <li>child：当前节点的子节点引用
这里需要注意一点，Zookeeper 是为读多写少的场景所设计。Znode 并不是用来存储大规模业务数据，而是用于存储少量的状态和配置信息，<strong>每个节点的数据最大不能超过 1MB</strong>。</li></ul> <h2 id="zookeeper-的基本操作"><a href="#zookeeper-的基本操作" class="header-anchor">#</a> Zookeeper 的基本操作</h2> <p>创建节点</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>create
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>删除节点</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>delete
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>判断节点是否存在</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>exists
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>获得一个节点的数据</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>getData
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>设置一个节点的数据</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>setData
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>获取节点下的所有子节点</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>getChildren
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>这其中，<code>exists</code>，<code>getData</code>，<code>getChildren</code> 属于读操作。Zookeeper 客户端在请求读操作的时候，可以选择是否设置 <strong>Watch</strong></p> <h2 id="zookeeper-的事件通知"><a href="#zookeeper-的事件通知" class="header-anchor">#</a> Zookeeper 的事件通知</h2> <p>我们可以把 <code>Watch</code> 理解成是注册在特定 Znode 上的触发器。当这个 Znode 发生改变，也就是调用了 <code>create</code> <code>delete</code> <code>setData</code>方法的时候，将会触发 <code>Znode</code> 上注册的对应事件，请求 Watch 的客户端会接收到异步通知。</p> <p>具体交互过程如下：</p> <ul><li>客户端调用 <code>getData</code> 方法，<code>watch</code> 参数是 true。服务端接到请求，返回节点数据，并且在对应的哈希表里插入被 Watch 的 Znode 路径，以及 Watcher 列表。
<img src="/img/microservice/zk14.png" alt="memorydoc"></li> <li>当被 Watch 的 Znode 已删除，服务端会查找哈希表，找到该 Znode 对应的所有 Watcher，异步通知客户端，并且删除哈希表中对应的 Key-Value。
<img src="/img/microservice/zk15.png" alt="memorydoc"></li></ul> <h2 id="zookeeper-的一致性"><a href="#zookeeper-的一致性" class="header-anchor">#</a> Zookeeper 的一致性</h2> <p>Zookeeper 身为分布式系统协调服务，如果自身挂了如何处理呢？为了防止单机挂掉的情况，Zookeeper 维护了一个集群。如下图：</p> <p><img src="/img/microservice/zk16.png" alt="memorydoc"></p> <p>Zookeeper Service 集群是一主多从结构。</p> <p>在更新数据时，首先更新到主节点（这里的节点是指服务器，不是 Znode），再同步到从节点。</p> <p>在读取数据时，直接读取任意从节点。</p> <p>为了保证主从节点的数据一致性，Zookeeper 采用了 ** ZAB 协议**，这种协议非常类似于一致性算法 <strong>Paxos</strong> 和 <strong>Raft</strong>。</p> <hr> <h4 id="什么是-zab"><a href="#什么是-zab" class="header-anchor">#</a> 什么是 ZAB</h4> <p>Zookeeper Atomic Broadcast，有效解决了 Zookeeper 集群崩溃恢复，以及主从同步数据的问题。</p> <h4 id="zab-协议定义的三种节点状态"><a href="#zab-协议定义的三种节点状态" class="header-anchor">#</a> ZAB 协议定义的三种节点状态</h4> <ul><li>Looking ：选举状态。</li> <li>Following ：Follower 节点（从节点）所处的状态。</li> <li>Leading ：Leader 节点（主节点）所处状态。</li></ul> <h4 id="最大-zxid"><a href="#最大-zxid" class="header-anchor">#</a> 最大 ZXID</h4> <p>最大 ZXID 也就是节点本地的最新事务编号，包含 epoch 和计数两部分。epoch 是纪元的意思，相当于 Raft 算法选主时候的 term。</p> <h4 id="zab-的崩溃恢复"><a href="#zab-的崩溃恢复" class="header-anchor">#</a> ZAB 的崩溃恢复</h4> <p>假如 Zookeeper 当前的主节点挂掉了，集群会进行崩溃恢复。ZAB 的崩溃恢复分成三个阶段：</p> <ul><li><strong>Leader election</strong></li></ul> <p>选举阶段，此时集群中的节点处于 Looking 状态。它们会各自向其他节点发起投票，投票当中包含自己的服务器 ID 和最新事务 ID（ZXID）。</p> <p><img src="/img/microservice/zk17.png" alt="memorydoc"></p> <p>接下来，节点会用自身的 ZXID 和从其他节点接收到的 ZXID 做比较，如果发现别人家的 ZXID 比自己大，也就是数据比自己新，那么就重新发起投票，投票给目前已知最大的 ZXID 所属节点。</p> <p><img src="/img/microservice/zk18.png" alt="memorydoc"></p> <p>每次投票后，服务器都会统计投票数量，判断是否有某个节点得到半数以上的投票。如果存在这样的节点，该节点将会成为准 Leader，状态变为 Leading。其他节点的状态变为 Following。</p> <p><img src="/img/microservice/zk19.png" alt="memorydoc"></p> <hr> <ul><li><strong>Discovery</strong></li></ul> <p>发现阶段，用于在从节点中发现最新的 ZXID 和事务日志。或许有人会问：既然 Leader 被选为主节点，已经是集群里数据最新的了，为什么还要从节点中寻找最新事务呢？</p> <p>这是为了防止某些意外情况，比如因网络原因在上一阶段产生多个 Leader 的情况。</p> <p>所以这一阶段，Leader 集思广益，接收所有 Follower 发来各自的最新 epoch 值。Leader 从中选出最大的 epoch，基于此值加 1，生成新的 epoch 分发给各个 Follower。</p> <p>各个 Follower 收到全新的 epoch 后，返回 ACK 给 Leader，带上各自最大的 ZXID 和历史事务日志。Leader 选出最大的 ZXID，并更新自身历史日志。</p> <ul><li><strong>Synchronization</strong></li></ul> <p>同步阶段，把 Leader 刚才收集得到的最新历史事务日志，同步给集群中所有的 Follower。只有当半数 Follower 同步成功，这个准 Leader 才能成为正式的 Leader。</p> <p>自此，故障恢复正式完成</p> <hr> <p><strong>ZAB 的数据写入</strong></p> <p><strong>Broadcast</strong></p> <p>ZAB 的数据写入涉及到 Broadcast 阶段，简单来说，就是 Zookeeper 常规情况下更新数据的时候，由 Leader 广播到所有的 Follower。其过程如下：</p> <ul><li>客户端发出写入数据请求给任意 Follower。</li> <li>Follower 把写入数据请求转发给 Leader。</li> <li>Leader 采用二阶段提交方式，先发送 Propose 广播给 Follower。</li> <li>Follower 接到 Propose 消息，写入日志成功后，返回 ACK 消息给 Leader。</li> <li>Leader 接到半数以上ACK消息，返回成功给客户端，并且广播 Commit 请求给 Follower</li></ul> <p><img src="/img/microservice/zk20.png" alt="memorydoc"></p> <p>ZAB 协议既不是强一致性，也不是弱一致性，而是处于两者之间的 <strong>单调一致性（顺序一致性）</strong>。它依靠事务 ID 和版本号，保证了数据的更新和读取是有序的。</p> <h2 id="zookeeper-的应用场景"><a href="#zookeeper-的应用场景" class="header-anchor">#</a> Zookeeper 的应用场景</h2> <h4 id="分布式锁"><a href="#分布式锁" class="header-anchor">#</a> 分布式锁</h4> <p>这是雅虎研究员设计 Zookeeper 的初衷。利用 Zookeeper 的临时顺序节点，可以轻松实现分布式锁。</p> <h4 id="服务注册和发现"><a href="#服务注册和发现" class="header-anchor">#</a> 服务注册和发现</h4> <p>利用 Znode 和 Watcher，可以实现分布式服务的注册和发现。最著名的应用就是阿里的分布式 RPC 框架 Dubbo。</p> <h4 id="共享配置和状态信息"><a href="#共享配置和状态信息" class="header-anchor">#</a> 共享配置和状态信息</h4> <p>Redis 的分布式解决方案 Codis，就利用了 Zookeeper 来存放数据路由表和 codis-proxy 节点的元信息。同时 codis-config 发起的命令都会通过 ZooKeeper 同步到各个存活的 codis-proxy。</p> <p>此外，Kafka、HBase、Hadoop，也都依靠Zookeeper同步节点信息，实现高可用。</p> <h2 id="基于-docker-安装-zookeeper"><a href="#基于-docker-安装-zookeeper" class="header-anchor">#</a> 基于 Docker 安装 Zookeeper</h2> <h3 id="概述"><a href="#概述" class="header-anchor">#</a> 概述</h3> <p>Zookeeper 部署有三种方式，单机模式、集群模式、伪集群模式，以下采用 Docker 的方式部署</p> <p><strong>注意：</strong> 集群为大于等于3个奇数，如 3、5、7,不宜太多，集群机器多了选举和数据同步耗时长，不稳定。</p> <h3 id="单机模式"><a href="#单机模式" class="header-anchor">#</a> 单机模式</h3> <h4 id="docker-compose-yml"><a href="#docker-compose-yml" class="header-anchor">#</a> docker-compose.yml</h4> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>version: <span class="token string">'3.1'</span>

services:
    zoo1:
        image: zookeeper
        restart: always
        hostname: zoo1
        ports:
            - <span class="token number">2181</span>:2181
        environment:
            ZOO_MY_ID: <span class="token number">1</span>
            ZOO_SERVERS: server.1<span class="token operator">=</span>zoo1:2888:3888
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h4 id="验证是否安装成功"><a href="#验证是否安装成功" class="header-anchor">#</a> 验证是否安装成功</h4> <ul><li>以交互的方式进入容器</li></ul> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">docker</span> <span class="token builtin class-name">exec</span> -it zookeeper_zoo1_1 /bin/bash
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>使用客户端连接到服务端</li></ul> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>bash-4.3<span class="token comment"># ./bin/zkCli.sh -server 192.168.75.130:2181</span>
Connecting to <span class="token number">192.168</span>.75.130:2181
<span class="token number">2017</span>-11-09 07:45:58,365 <span class="token punctuation">[</span>myid:<span class="token punctuation">]</span> - INFO  <span class="token punctuation">[</span>main:Environment@100<span class="token punctuation">]</span> - Client environment:zookeeper.version<span class="token operator">=</span><span class="token number">3.4</span>.10-39d3a4f269333c922ed3db283be479f9deacaa0f, built on 03/23/2017 <span class="token number">10</span>:13 GMT
<span class="token number">2017</span>-11-09 07:45:58,374 <span class="token punctuation">[</span>myid:<span class="token punctuation">]</span> - INFO  <span class="token punctuation">[</span>main:Environment@100<span class="token punctuation">]</span> - Client environment:host.name<span class="token operator">=</span>zoo1
<span class="token number">2017</span>-11-09 07:45:58,374 <span class="token punctuation">[</span>myid:<span class="token punctuation">]</span> - INFO  <span class="token punctuation">[</span>main:Environment@100<span class="token punctuation">]</span> - Client environment:java.version<span class="token operator">=</span><span class="token number">1.8</span>.0_131
<span class="token number">2017</span>-11-09 07:45:58,380 <span class="token punctuation">[</span>myid:<span class="token punctuation">]</span> - INFO  <span class="token punctuation">[</span>main:Environment@100<span class="token punctuation">]</span> - Client environment:java.vendor<span class="token operator">=</span>Oracle Corporation
<span class="token number">2017</span>-11-09 07:45:58,381 <span class="token punctuation">[</span>myid:<span class="token punctuation">]</span> - INFO  <span class="token punctuation">[</span>main:Environment@100<span class="token punctuation">]</span> - Client environment:java.home<span class="token operator">=</span>/usr/lib/jvm/java-1.8-openjdk/jre
<span class="token number">2017</span>-11-09 07:45:58,381 <span class="token punctuation">[</span>myid:<span class="token punctuation">]</span> - INFO  <span class="token punctuation">[</span>main:Environment@100<span class="token punctuation">]</span> - Client environment:java.class.path<span class="token operator">=</span>/zookeeper-3.4.10/bin/<span class="token punctuation">..</span>/build/classes:/zookeeper-3.4.10/bin/<span class="token punctuation">..</span>/build/lib/*.jar:/zookeeper-3.4.10/bin/<span class="token punctuation">..</span>/lib/slf4j-log4j12-1.6.1.jar:/zookeeper-3.4.10/bin/<span class="token punctuation">..</span>/lib/slf4j-api-1.6.1.jar:/zookeeper-3.4.10/bin/<span class="token punctuation">..</span>/lib/netty-3.10.5.Final.jar:/zookeeper-3.4.10/bin/<span class="token punctuation">..</span>/lib/log4j-1.2.16.jar:/zookeeper-3.4.10/bin/<span class="token punctuation">..</span>/lib/jline-0.9.94.jar:/zookeeper-3.4.10/bin/<span class="token punctuation">..</span>/zookeeper-3.4.10.jar:/zookeeper-3.4.10/bin/<span class="token punctuation">..</span>/src/java/lib/*.jar:/conf:
<span class="token number">2017</span>-11-09 07:45:58,381 <span class="token punctuation">[</span>myid:<span class="token punctuation">]</span> - INFO  <span class="token punctuation">[</span>main:Environment@100<span class="token punctuation">]</span> - Client environment:java.library.path<span class="token operator">=</span>/usr/lib/jvm/java-1.8-openjdk/jre/lib/amd64/server:/usr/lib/jvm/java-1.8-openjdk/jre/lib/amd64:/usr/lib/jvm/java-1.8-openjdk/jre/<span class="token punctuation">..</span>/lib/amd64:/usr/java/packages/lib/amd64:/usr/lib64:/lib64:/lib:/usr/lib
<span class="token number">2017</span>-11-09 07:45:58,381 <span class="token punctuation">[</span>myid:<span class="token punctuation">]</span> - INFO  <span class="token punctuation">[</span>main:Environment@100<span class="token punctuation">]</span> - Client environment:java.io.tmpdir<span class="token operator">=</span>/tmp
<span class="token number">2017</span>-11-09 07:45:58,381 <span class="token punctuation">[</span>myid:<span class="token punctuation">]</span> - INFO  <span class="token punctuation">[</span>main:Environment@100<span class="token punctuation">]</span> - Client environment:java.compiler<span class="token operator">=</span><span class="token operator">&lt;</span>NA<span class="token operator">&gt;</span>
<span class="token number">2017</span>-11-09 07:45:58,381 <span class="token punctuation">[</span>myid:<span class="token punctuation">]</span> - INFO  <span class="token punctuation">[</span>main:Environment@100<span class="token punctuation">]</span> - Client environment:os.name<span class="token operator">=</span>Linux
<span class="token number">2017</span>-11-09 07:45:58,382 <span class="token punctuation">[</span>myid:<span class="token punctuation">]</span> - INFO  <span class="token punctuation">[</span>main:Environment@100<span class="token punctuation">]</span> - Client environment:os.arch<span class="token operator">=</span>amd64
<span class="token number">2017</span>-11-09 07:45:58,382 <span class="token punctuation">[</span>myid:<span class="token punctuation">]</span> - INFO  <span class="token punctuation">[</span>main:Environment@100<span class="token punctuation">]</span> - Client environment:os.version<span class="token operator">=</span><span class="token number">4.4</span>.0-98-generic
<span class="token number">2017</span>-11-09 07:45:58,386 <span class="token punctuation">[</span>myid:<span class="token punctuation">]</span> - INFO  <span class="token punctuation">[</span>main:Environment@100<span class="token punctuation">]</span> - Client environment:user.name<span class="token operator">=</span>root
<span class="token number">2017</span>-11-09 07:45:58,386 <span class="token punctuation">[</span>myid:<span class="token punctuation">]</span> - INFO  <span class="token punctuation">[</span>main:Environment@100<span class="token punctuation">]</span> - Client environment:user.home<span class="token operator">=</span>/root
<span class="token number">2017</span>-11-09 07:45:58,386 <span class="token punctuation">[</span>myid:<span class="token punctuation">]</span> - INFO  <span class="token punctuation">[</span>main:Environment@100<span class="token punctuation">]</span> - Client environment:user.dir<span class="token operator">=</span>/zookeeper-3.4.10
<span class="token number">2017</span>-11-09 07:45:58,389 <span class="token punctuation">[</span>myid:<span class="token punctuation">]</span> - INFO  <span class="token punctuation">[</span>main:ZooKeeper@438<span class="token punctuation">]</span> - Initiating client connection, <span class="token assign-left variable">connectString</span><span class="token operator">=</span><span class="token number">192.168</span>.75.130:2181 <span class="token assign-left variable">sessionTimeout</span><span class="token operator">=</span><span class="token number">30000</span> <span class="token assign-left variable">watcher</span><span class="token operator">=</span>org.apache.zookeeper.ZooKeeperMain<span class="token variable">$MyWatcher</span>@3eb07fd3
<span class="token number">2017</span>-11-09 07:45:58,428 <span class="token punctuation">[</span>myid:<span class="token punctuation">]</span> - INFO  <span class="token punctuation">[</span>main-SendThread<span class="token punctuation">(</span><span class="token number">192.168</span>.75.130:2181<span class="token punctuation">)</span>:ClientCnxn<span class="token variable">$SendThread</span>@1032<span class="token punctuation">]</span> - Opening socket connection to server <span class="token number">192.168</span>.75.130/192.168.75.130:2181. Will not attempt to authenticate using SASL <span class="token punctuation">(</span>unknown error<span class="token punctuation">)</span>
Welcome to ZooKeeper<span class="token operator">!</span>
JLine support is enabled
<span class="token number">2017</span>-11-09 07:45:58,529 <span class="token punctuation">[</span>myid:<span class="token punctuation">]</span> - INFO  <span class="token punctuation">[</span>main-SendThread<span class="token punctuation">(</span><span class="token number">192.168</span>.75.130:2181<span class="token punctuation">)</span>:ClientCnxn<span class="token variable">$SendThread</span>@876<span class="token punctuation">]</span> - Socket connection established to <span class="token number">192.168</span>.75.130/192.168.75.130:2181, initiating session
<span class="token punctuation">[</span>zk: <span class="token number">192.168</span>.75.130:2181<span class="token punctuation">(</span>CONNECTING<span class="token punctuation">)</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token number">2017</span>-11-09 07:45:58,573 <span class="token punctuation">[</span>myid:<span class="token punctuation">]</span> - INFO  <span class="token punctuation">[</span>main-SendThread<span class="token punctuation">(</span><span class="token number">192.168</span>.75.130:2181<span class="token punctuation">)</span>:ClientCnxn<span class="token variable">$SendThread</span>@1299<span class="token punctuation">]</span> - Session establishment complete on server <span class="token number">192.168</span>.75.130/192.168.75.130:2181, sessionid <span class="token operator">=</span> 0x15f9fbc12ec0000, negotiated <span class="token function">timeout</span> <span class="token operator">=</span> <span class="token number">30000</span>

WATCHER::

WatchedEvent state:SyncConnected type:None path:null
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><ul><li>使用服务端工具检查服务器状态</li></ul> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>bash-4.3<span class="token comment"># ./bin/zkServer.sh status</span>
ZooKeeper JMX enabled by default
Using config: /conf/zoo.cfg
Mode: standalone
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="集群模式"><a href="#集群模式" class="header-anchor">#</a> 集群模式</h3> <h4 id="第一台主机"><a href="#第一台主机" class="header-anchor">#</a> 第一台主机</h4> <h4 id="docker-compose-yml-2"><a href="#docker-compose-yml-2" class="header-anchor">#</a> docker-compose.yml</h4> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>version: <span class="token string">'3.1'</span>
services:
    zoo1:
        image: zookeeper
        restart: always
        environment:
            ZOO_MY_ID: <span class="token number">1</span>
            ZOO_SERVERS: server.1<span class="token operator">=</span><span class="token number">192.168</span>.75.130:2888:3888 server.2<span class="token operator">=</span><span class="token number">192.168</span>.75.134:2888:3888 server.3<span class="token operator">=</span><span class="token number">192.168</span>.75.135:2888:3888
        network_mode: <span class="token function">host</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h4 id="验证测试"><a href="#验证测试" class="header-anchor">#</a> 验证测试</h4> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>root@UbuntuBase:/usr/local/docker/zookeeper<span class="token comment"># docker exec -it zookeeper_zoo1_1 /bin/bash</span>
bash-4.3<span class="token comment"># ./bin/zkServer.sh status</span>
ZooKeeper JMX enabled by default
Using config: /conf/zoo.cfg
Mode: leader
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="第二台主机"><a href="#第二台主机" class="header-anchor">#</a> 第二台主机</h4> <h4 id="docker-compose-yml-3"><a href="#docker-compose-yml-3" class="header-anchor">#</a> docker-compose.yml</h4> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>
version: <span class="token string">'3.1'</span>
services:
    zoo2:
        image: zookeeper
        restart: always
        environment:
            ZOO_MY_ID: <span class="token number">2</span>
            ZOO_SERVERS: server.1<span class="token operator">=</span><span class="token number">192.168</span>.75.130:2888:3888 server.2<span class="token operator">=</span><span class="token number">192.168</span>.75.134:2888:3888 server.3<span class="token operator">=</span><span class="token number">192.168</span>.75.135:2888:3888
        network_mode: <span class="token function">host</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h4 id="验证测试-2"><a href="#验证测试-2" class="header-anchor">#</a> 验证测试</h4> <p>root@UbuntuBase:/usr/local/docker/zookeeper# docker exec -it zookeeper_zoo2_1 /bin/bash
bash-4.3# ./bin/zkServer.sh status
ZooKeeper JMX enabled by default
Using config: /conf/zoo.cfg
Mode: follower</p> <h4 id="第三台主机"><a href="#第三台主机" class="header-anchor">#</a> 第三台主机</h4> <h4 id="docker-compose-yml-4"><a href="#docker-compose-yml-4" class="header-anchor">#</a> docker-compose.yml</h4> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>version: <span class="token string">'3.1'</span>
services:
    zoo3:
        image: zookeeper
        restart: always
        environment:
            ZOO_MY_ID: <span class="token number">3</span>
            ZOO_SERVERS: server.1<span class="token operator">=</span><span class="token number">192.168</span>.75.130:2888:3888 server.2<span class="token operator">=</span><span class="token number">192.168</span>.75.134:2888:3888 server.3<span class="token operator">=</span><span class="token number">192.168</span>.75.135:2888:3888
        network_mode: <span class="token function">host</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h4 id="验证测试-3"><a href="#验证测试-3" class="header-anchor">#</a> 验证测试</h4> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>root@UbuntuBase:/usr/local/docker/zookeeper<span class="token comment"># docker exec -it zookeeper_zoo3_1 /bin/bash</span>
bash-4.3<span class="token comment"># ./bin/zkServer.sh status</span>
ZooKeeper JMX enabled by default
Using config: /conf/zoo.cfg
Mode: follower
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>伪集群模式</p> <h1 id="docker-compose-yml-5"><a href="#docker-compose-yml-5" class="header-anchor">#</a> docker-compose.yml</h1> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>version: <span class="token string">'3.1'</span>
services:
    zoo1:
        image: zookeeper
        restart: always
        hostname: zoo1
        ports:
            - <span class="token number">2181</span>:2181
        environment:
            ZOO_MY_ID: <span class="token number">1</span>
            ZOO_SERVERS: server.1<span class="token operator">=</span>zoo1:2888:3888 server.2<span class="token operator">=</span>zoo2:2888:3888 server.3<span class="token operator">=</span>zoo3:2888:3888

    zoo2:
        image: zookeeper
        restart: always
        hostname: zoo2
        ports:
            - <span class="token number">2182</span>:2181
        environment:
            ZOO_MY_ID: <span class="token number">2</span>
            ZOO_SERVERS: server.1<span class="token operator">=</span>zoo1:2888:3888 server.2<span class="token operator">=</span>zoo2:2888:3888 server.3<span class="token operator">=</span>zoo3:2888:3888

    zoo3:
        image: zookeeper
        restart: always
        hostname: zoo3
        ports:
            - <span class="token number">2183</span>:2181
        environment:
            ZOO_MY_ID: <span class="token number">3</span>
            ZOO_SERVERS: server.1<span class="token operator">=</span>zoo1:2888:3888 server.2<span class="token operator">=</span>zoo2:2888:3888 server.3<span class="token operator">=</span>zoo3:2888:3888
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><h4 id="验证是否安装成功-2"><a href="#验证是否安装成功-2" class="header-anchor">#</a> 验证是否安装成功</h4> <ul><li>分别以交互方式进入容器查看</li></ul> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">docker</span> <span class="token builtin class-name">exec</span> -it zookeeper_zoo1_1 /bin/bash
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">docker</span> <span class="token builtin class-name">exec</span> -it zookeeper_zoo2_1 /bin/bash
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">docker</span> <span class="token builtin class-name">exec</span> -it zookeeper_zoo3_1 /bin/bash
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>使用服务端工具检查服务器状态</li></ul> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>root@UbuntuBase:/usr/local/docker/zookeeper<span class="token comment"># docker exec -it zookeeper_zoo1_1 /bin/bash</span>
bash-4.3<span class="token comment"># ./bin/zkServer.sh status</span>
ZooKeeper JMX enabled by default
Using config: /conf/zoo.cfg
Mode: follower
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language-sh line-numbers-mode"><pre class="language-sh"><code>root@UbuntuBase:/usr/local/docker/zookeeper<span class="token comment"># docker exec -it zookeeper_zoo2_1 /bin/bash</span>
bash-4.3<span class="token comment"># ./bin/zkServer.sh status</span>
ZooKeeper JMX enabled by default
Using config: /conf/zoo.cfg
Mode: follower
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language-sh line-numbers-mode"><pre class="language-sh"><code>root@UbuntuBase:/usr/local/docker/zookeeper<span class="token comment"># docker exec -it zookeeper_zoo3_1 /bin/bash</span>
bash-4.3<span class="token comment"># ./bin/zkServer.sh status</span>
ZooKeeper JMX enabled by default
Using config: /conf/zoo.cfg
Mode: leader
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>从上面的验证结果可以看出：zoo1 为跟随者，zoo2 为跟随者，zoo3 为领导者</p> <h2 id="附-linux-下手动安装-zookeeper"><a href="#附-linux-下手动安装-zookeeper" class="header-anchor">#</a> 附：Linux 下手动安装 Zookeeper</h2> <p>Zookeeper 部署有三种方式，单机模式、集群模式、伪集群模式，以下采用手动安装的方式部署</p> <p><strong>注意：</strong> 集群为大于等于3个奇数，如 3、5、7,不宜太多，集群机器多了选举和数据同步耗时长，不稳定。</p> <p>单机模式</p> <h4 id="下载"><a href="#下载" class="header-anchor">#</a> 下载</h4> <p>进入要下载的版本的目录，选择 <code>.tar.gz</code> 文件下载，下载链接：http://archive.apache.org/dist/zookeeper/</p> <p>####安装
注意： 需要先安装 <code>Java</code></p> <p>使用 tar 解压要安装的目录即可，以 3.4.13 版本为例，解压到 <code> /usr/local/zookeeper-3.4.13</code></p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">tar</span> -zxvf zookeeper-3.4.13.tar.gz -C /usr/local
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="配置"><a href="#配置" class="header-anchor">#</a> 配置</h4> <p>在根目录下创建 data 和 logs 两个目录用于存储数据和日志</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token builtin class-name">cd</span> /usr/local/zookeeper-3.4.13
<span class="token function">mkdir</span> data
<span class="token function">mkdir</span> logs
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>在 conf 目录下新建 zoo.cfg 文件，写入以下内容保存</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token assign-left variable">tickTime</span><span class="token operator">=</span><span class="token number">2000</span>
<span class="token assign-left variable">dataDir</span><span class="token operator">=</span>/usr/local/zookeeper-3.4.13/data
<span class="token assign-left variable">dataLogDir</span><span class="token operator">=</span>/usr/local/zookeeper-3.4.13/logs
<span class="token assign-left variable">clientPort</span><span class="token operator">=</span><span class="token number">2181</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="启动和停止"><a href="#启动和停止" class="header-anchor">#</a> 启动和停止</h4> <p>进入 bin 目录，启动、停止、重启和查看当前节点状态</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>./zkServer.sh start
./zkServer.sh stop
./zkServer.sh restart
./zkServer.sh status
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="伪集群模式"><a href="#伪集群模式" class="header-anchor">#</a> 伪集群模式</h3> <p>伪集群模式就是在同一主机启动多个 zookeeper 并组成集群，下边以在 192.168.10.134 主机上创 3 个 zookeeper 组集群为例。</p> <p>将通过单机模式安装的 zookeeper，复制成 zookeeper1/zookeeper2/zookeeper3 三份</p> <h4 id="zookeeper1"><a href="#zookeeper1" class="header-anchor">#</a> zookeeper1</h4> <p>修改配置文件</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token assign-left variable">tickTime</span><span class="token operator">=</span><span class="token number">2000</span>
<span class="token assign-left variable">dataDir</span><span class="token operator">=</span>/usr/local/zookeeper1/data
<span class="token assign-left variable">dataLogDir</span><span class="token operator">=</span>/usr/local/zookeeper1/logs
<span class="token assign-left variable">clientPort</span><span class="token operator">=</span><span class="token number">2181</span>
<span class="token assign-left variable">initLimit</span><span class="token operator">=</span><span class="token number">5</span>
<span class="token assign-left variable">syncLimit</span><span class="token operator">=</span><span class="token number">2</span>
server.1<span class="token operator">=</span><span class="token number">192.168</span>.10.134:2888:3888
server.2<span class="token operator">=</span><span class="token number">192.168</span>.10.134:4888:5888
server.3<span class="token operator">=</span><span class="token number">192.168</span>.10.134:6888:7888
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>设置服务器 ID
echo '1' &gt; data/myid</p> <h4 id="zookeeper2"><a href="#zookeeper2" class="header-anchor">#</a> zookeeper2</h4> <p>修改配置文件</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token assign-left variable">tickTime</span><span class="token operator">=</span><span class="token number">2000</span>
<span class="token assign-left variable">dataDir</span><span class="token operator">=</span>/usr/local/zookeeper2/data
<span class="token assign-left variable">dataLogDir</span><span class="token operator">=</span>/usr/local/zookeeper2/logs
<span class="token assign-left variable">clientPort</span><span class="token operator">=</span><span class="token number">2181</span>
<span class="token assign-left variable">initLimit</span><span class="token operator">=</span><span class="token number">5</span>
<span class="token assign-left variable">syncLimit</span><span class="token operator">=</span><span class="token number">2</span>
server.1<span class="token operator">=</span><span class="token number">192.168</span>.10.134:2888:3888
server.2<span class="token operator">=</span><span class="token number">192.168</span>.10.134:4888:5888
server.3<span class="token operator">=</span><span class="token number">192.168</span>.10.134:6888:7888
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>设置服务器 ID</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token builtin class-name">echo</span> <span class="token string">'2'</span> <span class="token operator">&gt;</span> data/myid
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="zookeeper3"><a href="#zookeeper3" class="header-anchor">#</a> zookeeper3</h4> <p>修改配置文件</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token assign-left variable">tickTime</span><span class="token operator">=</span><span class="token number">2000</span>
<span class="token assign-left variable">dataDir</span><span class="token operator">=</span>/usr/local/zookeeper3/data
<span class="token assign-left variable">dataLogDir</span><span class="token operator">=</span>/usr/local/zookeeper3/logs
<span class="token assign-left variable">clientPort</span><span class="token operator">=</span><span class="token number">2181</span>
<span class="token assign-left variable">initLimit</span><span class="token operator">=</span><span class="token number">5</span>
<span class="token assign-left variable">syncLimit</span><span class="token operator">=</span><span class="token number">2</span>
server.1<span class="token operator">=</span><span class="token number">192.168</span>.10.134:2888:3888
server.2<span class="token operator">=</span><span class="token number">192.168</span>.10.134:4888:5888
server.3<span class="token operator">=</span><span class="token number">192.168</span>.10.134:6888:7888
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>设置服务器 ID</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token builtin class-name">echo</span> <span class="token string">'3'</span> <span class="token operator">&gt;</span> data/myid
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="启动和停止-2"><a href="#启动和停止-2" class="header-anchor">#</a> 启动和停止</h3> <p>分别启动服务器，顺序无所谓</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>
./zkServer.sh start
./zkServer.sh stop
./zkServer.sh restart
./zkServer.sh status
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="集群模式-2"><a href="#集群模式-2" class="header-anchor">#</a> 集群模式</h3> <p>集群模式就是在不同主机上安装 zookeeper 然后组成集群的模式，操作步骤同上，此处不再赘述</p> <h2 id="zookeeper-配置说明"><a href="#zookeeper-配置说明" class="header-anchor">#</a> Zookeeper 配置说明</h2> <h3 id="zookeeper-的三种工作模式"><a href="#zookeeper-的三种工作模式" class="header-anchor">#</a> Zookeeper 的三种工作模式</h3> <ul><li>单机模式：存在单点故障</li> <li>集群模式：在多台机器上部署 Zookeeper 集群，适合线上环境使用。</li> <li>伪集群模式：在一台机器同时运行多个 Zookeeper 实例，仍然有单点故障问题，当然，其中配置的端口号要错开的，适合实验环境模拟集群使用。</li></ul> <h3 id="zookeeper-的三种端口号"><a href="#zookeeper-的三种端口号" class="header-anchor">#</a> Zookeeper 的三种端口号</h3> <ul><li>2181：客户端连接 Zookeeper 集群使用的监听端口号</li> <li>3888：选举 leader 使用</li> <li>2888：集群内机器通讯使用（Leader 和 Follower 之间数据同步使用的端口号，Leader 监听此端口）</li></ul> <h3 id="zookeeper-单机模式配置文件"><a href="#zookeeper-单机模式配置文件" class="header-anchor">#</a> Zookeeper 单机模式配置文件</h3> <p>配置文件路径：<code>/conf/zoo.cfg</code></p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token assign-left variable">clientPort</span><span class="token operator">=</span><span class="token number">2181</span>
<span class="token assign-left variable">dataDir</span><span class="token operator">=</span>/data
<span class="token assign-left variable">dataLogDir</span><span class="token operator">=</span>/datalog
<span class="token assign-left variable">tickTime</span><span class="token operator">=</span><span class="token number">2000</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li>clientPort：这个端口就是客户端连接 Zookeeper 服务器的端口，Zookeeper 会监听这个端口，接受客户端的访问请求。</li> <li>dataDir：Zookeeper 保存数据的目录。</li> <li>dataLogDir：Zookeeper 保存日志的目录。</li> <li>tickTime：这个时间是作为 Zookeeper 服务器之间或客户端与服务器之间维持心跳的时间间隔，也就是每隔 tickTime 时间就会发送一个心跳。</li></ul> <h3 id="zookeeper-集群模式配置文件"><a href="#zookeeper-集群模式配置文件" class="header-anchor">#</a> Zookeeper 集群模式配置文件</h3> <p>配置文件路径：<code>/conf/zoo.cfg</code></p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token assign-left variable">clientPort</span><span class="token operator">=</span><span class="token number">2181</span>
<span class="token assign-left variable">dataDir</span><span class="token operator">=</span>/data
<span class="token assign-left variable">dataLogDir</span><span class="token operator">=</span>/datalog
<span class="token assign-left variable">tickTime</span><span class="token operator">=</span><span class="token number">2000</span>
<span class="token assign-left variable">initLimit</span><span class="token operator">=</span><span class="token number">5</span>
<span class="token assign-left variable">syncLimit</span><span class="token operator">=</span><span class="token number">2</span>
autopurge.snapRetainCount<span class="token operator">=</span><span class="token number">3</span>
autopurge.purgeInterval<span class="token operator">=</span><span class="token number">0</span>
<span class="token assign-left variable">maxClientCnxns</span><span class="token operator">=</span><span class="token number">60</span>
server.1<span class="token operator">=</span><span class="token number">192.168</span>.0.1:2888:3888
server.2<span class="token operator">=</span><span class="token number">192.168</span>.0.2:2888:3888
server.3<span class="token operator">=</span><span class="token number">192.168</span>.0.3:2888:3888
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><ul><li>initLimit：配置 Zookeeper 接受客户端（这里所说的客户端不是用户连接 Zookeeper 服务器的客户端，而是 Zookeeper 服务器集群中连接到 Leader 的 Follower 服务器）初始化连接时最长能忍受多少个心跳时间间隔数。当已经超过 initLimit（默认为 10） 个心跳的时间（也就是 tickTime）长度后 Zookeeper 服务器还没有收到客户端的返回信息，那么表明这个客户端连接失败。总的时间长度就是 5 * 2000 = 10 秒</li> <li>syncLimit：配置 Leader 与 Follower 之间发送消息，请求和应答时间长度，最长不能超过多少个 tickTime 的时间长度，总的时间长度就是 2 * 2000 = 4 秒</li> <li>定时清理（Zookeeper 从 3.4.0 开始提供了自动清理快照和事务日志的功能）以下两个参数配合使用：
<ul><li>autopurge.purgeInterval：指定了清理频率，单位是小时，需要填写一个 1 或更大的整数，默认是 0，表示不开启自己清理功能。</li> <li>autopurge.snapRetainCount：指定了需要保留的文件数目。默认是保留 3 个。</li></ul></li> <li>maxClientCnxns：限制连接到 Zookeeper 的客户端的数量，限制并发连接的数量，它通过 IP 来区分不同的客户端。此配置选项可以用来阻止某些类别的 Dos 攻击。将它设置为 0 或者忽略而不进行设置将会取消对并发连接的限制。</li> <li>server.A=B：C：D：其中 A 是一个数字，表示这个是第几号服务器。B 是这个服务器的 IP 地址。C 表示的是这个服务器与集群中的 Leader 服务器交换信息的端口(2888)；D 表示的是万一集群中的 Leader 服务器挂了，需要一个端口来重新进行选举，选出一个新的 Leader，而这个端口就是用来执行选举时服务器相互通信的端口(3888)。如果是伪集群的配置方式，由于 B 都是一样，所以不同的 Zookeeper 实例通信端口号不能一样，所以要给它们分配不同的端口号。
注意： server.A 中的 A 是在 dataDir 配置的目录中创建一个名为 myid 的文件里的值（如：1）</li></ul> <h4 id="zookeeper-常用命令"><a href="#zookeeper-常用命令" class="header-anchor">#</a> Zookeeper 常用命令</h4> <h4 id="zkserver"><a href="#zkserver" class="header-anchor">#</a> zkServer</h4> <p>启动服务</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>./zkServer.sh start
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>停止服务</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>./zkServer.sh stop
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>重启服务</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>./zkServer.sh restart
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>执行状态</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>./zkServer.sh status
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="zkclient"><a href="#zkclient" class="header-anchor">#</a> zkClient</h4> <p>客户端连接服务器并进入 Bash 模式</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>./zkCli.sh -server <span class="token operator">&lt;</span>ip<span class="token operator">&gt;</span>:<span class="token operator">&lt;</span>port<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="命令参数"><a href="#命令参数" class="header-anchor">#</a> 命令参数</h4> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>ZooKeeper -server host:port cmd args
	<span class="token function">stat</span> path <span class="token punctuation">[</span>watch<span class="token punctuation">]</span>
	<span class="token builtin class-name">set</span> path data <span class="token punctuation">[</span>version<span class="token punctuation">]</span>
	<span class="token function">ls</span> path <span class="token punctuation">[</span>watch<span class="token punctuation">]</span>
	delquota <span class="token punctuation">[</span>-n<span class="token operator">|</span>-b<span class="token punctuation">]</span> path
	ls2 path <span class="token punctuation">[</span>watch<span class="token punctuation">]</span>
	setAcl path acl
	setquota -n<span class="token operator">|</span>-b val path
	<span class="token function">history</span> 
	redo cmdno
	printwatches on<span class="token operator">|</span>off
	delete path <span class="token punctuation">[</span>version<span class="token punctuation">]</span>
	<span class="token function">sync</span> path
	listquota path
	rmr path
	get path <span class="token punctuation">[</span>watch<span class="token punctuation">]</span>
	create <span class="token punctuation">[</span>-s<span class="token punctuation">]</span> <span class="token punctuation">[</span>-e<span class="token punctuation">]</span> path data acl
	addauth scheme auth
	quit 
	getAcl path
	close 
	connect host:port
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><ul><li>创建节点（Bash 模式）</li></ul> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>create /test <span class="token string">&quot;hello zookeeper&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>查询节点（Bash 模式）</li></ul> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>get /test

<span class="token comment">#### 输出如下</span>
Hello Zookeeper
cZxid <span class="token operator">=</span> 0x100000004
ctime <span class="token operator">=</span> Fri Oct <span class="token number">19</span> 05:11:47 GMT <span class="token number">2018</span>
mZxid <span class="token operator">=</span> 0x100000004
mtime <span class="token operator">=</span> Fri Oct <span class="token number">19</span> 05:11:47 GMT <span class="token number">2018</span>
pZxid <span class="token operator">=</span> 0x100000004
cversion <span class="token operator">=</span> <span class="token number">0</span>
dataVersion <span class="token operator">=</span> <span class="token number">0</span>
aclVersion <span class="token operator">=</span> <span class="token number">0</span>
ephemeralOwner <span class="token operator">=</span> 0x0
dataLength <span class="token operator">=</span> <span class="token number">15</span>
numChildren <span class="token operator">=</span> <span class="token number">0</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><ul><li>删除节点（Bash 模式）</li></ul> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>delete
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></div></div>  <div class="page-edit"><div class="edit-link"><a href="https://github.com/Memorydoc/edit/master/docs/03.技术架构/110.微服务/40.Zookeeper.md" target="_blank" rel="noopener noreferrer">编辑</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2022/03/08, 00:59:33</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/a0f472/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">分布式锁</div></a> <a href="/pages/9d5b5a/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">定时任务</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/a0f472/" class="prev">分布式锁</a></span> <span class="next"><a href="/pages/9d5b5a/">定时任务</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/964fc2fdsa56/"><div>
            命令模式
            <span class="title-tag">
              原创
            </span></div></a> <span class="date">05-03</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/964fc2fdsa3/"><div>
            桥接模式
            <span class="title-tag">
              原创
            </span></div></a> <span class="date">05-02</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/7a6d3a21/"><div>
            优雅写代码三
            <span class="title-tag">
              原创
            </span></div></a> <span class="date">04-29</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:17615195790@163.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/Memorydoc" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://music.163.com/#/playlist?id=755597173" title="听音乐" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by
  <a href="https://github.com/Memorydoc/memorydoc-vuepress-blog" target="_blank" title="本站主题">Memorydoc</a> 
    | Copyright © 2021-2022
    <span>Memorydoc | <a href="https://github.com/Memorydoc/memorydoc-vuepress-blog/blob/master/LICENSE" target="_blank">MIT License</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"><div></div></div></div>
    <script src="/assets/js/app.25d5bd39.js" defer></script><script src="/assets/js/2.da1b78fa.js" defer></script><script src="/assets/js/3.c45fb83a.js" defer></script><script src="/assets/js/90.76049e9d.js" defer></script>
  </body>
</html>
